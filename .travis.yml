dist: trusty
sudo: true
language: r
cache: packages

env:
  global:
    - _R_CHECK_TESTS_NLINES_=999
    - _R_CHECK_LENGTH_1_CONDITION_=true

addons:
  apt:
    packages:
      - libopenmpi-dev
      - openmpi-bin
      - slurm-llnl 

r:
  - oldrel
  - release
  - devel

r_packages:
  - covr
  - Rmpi

script:
  - sudo cp inst/conf/slurm.conf /etc/slurm-llnl
  - cp batchtools.conf.R tests/testthat
  - sudo service munge start
  - sudo /etc/init.d/slurmctld restart
  - sudo /etc/init.d/slurmd restart
  - sinfo
  - R CMD build .
  - R CMD check *tar.gz

after_success:
  - if [[ "${TRAVIS_R_VERSION_STRING}" == "release" ]]; then Rscript -e 'covr::coveralls()'; fi

  